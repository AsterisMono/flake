{
  config,
  pkgs,
  lib,
  ...
}:
let
  inherit (lib) mkOption types;
  cfg = config.noa.dn42;
  peerOpts = _: {
    options = {
      endpoint = mkOption {
        example = "home.kagura.lolicon.cyou";
        type = types.str;
        description = ''
          The endpoint of the peer.
        '';
      };
      port = mkOption {
        example = 20833;
        type = types.int;
        description = ''
          The port wireguard should connect to.
        '';
      };
      pubkey = mkOption {
        example = "z3XndJnzBW9D+S6flQ+nlJH+WlrCcGtImdN4kUb/LGM=";
        type = types.str;
        description = ''
          The pubkey of the peer.
        '';
      };
      ipv6Addrs = mkOption {
        example = [ "ee80:759::2323/64" ];
        type = types.listOf types.str;
        description = ''
          The ipv6 addresses of the peer.
        '';
      };
      ipv4Addrs = mkOption {
        example = [ "172.22.76.185" ];
        type = types.listOf types.str;
        description = ''
          The ipv4 addresses of the peer.
        '';
      };
    };
  };
  generateInterfaces =
    asn: values:
    lib.nameValuePair "dn42-${asn}" {
    };
in
{
  options = {
    noa.dn42 = {
      peers = mkOption {
        description = "DN42 Peers";
        default = { };
        example = {
          "AS4242422323" = {
            endpoint = "home.kagura.lolicon.cyou";
            port = 20833;
            pubkey = "z3XndJnzBW9D+S6flQ+nlJH+WlrCcGtImdN4kUb/LGM=";
            ipv6Addrs = [ "ee80:759::2323/64" ];
          };
        };
        type = with types; attrsOf (submodule peerOpts);
      };
      privateKeyFile = mkOption {
        default = null;
        type = types.str;
        description = ''
          Private key file as generated by {command}`wg genkey`.
        '';
      };
    };
  };

  config = lib.mkIf (cfg.peers != { }) {

  };
}
